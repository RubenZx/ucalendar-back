# Migration `20200908103156`

This migration has been generated by RubenZx at 9/8/2020, 12:31:56 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE `ucalendar`.`TimeTableSubject` DROP FOREIGN KEY `TimeTableSubject_ibfk_1`

ALTER TABLE `ucalendar`.`TimeTableSubject` DROP FOREIGN KEY `TimeTableSubject_ibfk_2`

CREATE TABLE `ucalendar`.`TimeTableTimeTableItem` (
`timeTableId` int NOT NULL ,
`timeTableItemId` int NOT NULL ,
PRIMARY KEY (`timeTableId`,`timeTableItemId`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

ALTER TABLE `ucalendar`.`TimeTableTimeTableItem` ADD FOREIGN KEY (`timeTableId`) REFERENCES `ucalendar`.`TimeTable`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `ucalendar`.`TimeTableTimeTableItem` ADD FOREIGN KEY (`timeTableItemId`) REFERENCES `ucalendar`.`TimeTableItem`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

DROP TABLE `ucalendar`.`TimeTableSubject`;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200908102031..20200908103156
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "mysql"
-  url = "***"
+  url = "***"
 }
 enum Role {
   ALUMN
@@ -13,12 +13,12 @@
   ADMINISTRATOR
 }
 model TimeTable {
-  id       Int                @default(autoincrement()) @id
-  user     User               @relation(fields: [userId], references: [uid])
-  userId   String
-  subjects TimeTableSubject[]
+  id             Int                      @default(autoincrement()) @id
+  user           User                     @relation(fields: [userId], references: [uid])
+  userId         String
+  timeTableItems TimeTableTimeTableItem[]
 }
 model User {
   uid           String              @id
@@ -27,9 +27,9 @@
   lastName      String?
   role          Role                @default(ALUMN)
   subjects      UserSubject[]
   timeTableItem UserTimeTableItem[]
-  TimeTable     TimeTable[]
+  timeTable     TimeTable[]
 }
 model Degree {
   id       Int             @id
@@ -58,23 +58,23 @@
   user          UserSubject[]
 }
 model TimeTableItem {
-  id           Int                 @default(autoincrement()) @id
+  id           Int                      @default(autoincrement()) @id
   startHour    String
   endHour      String
   type         String
   dayOfTheWeek Int
   colorBg      String
   colorAbrev   String
   weeks        Json
   users        UserTimeTableItem[]
-  timetables   TimeTableSubject[]
-  classRoom    ClassRoom           @relation(fields: [classRoomId], references: [id])
+  timetables   TimeTableTimeTableItem[]
+  classRoom    ClassRoom                @relation(fields: [classRoomId], references: [id])
   classRoomId  Int
-  group        Group               @relation(fields: [groupId], references: [id])
+  group        Group                    @relation(fields: [groupId], references: [id])
   groupId      Int
-  subject      Subject             @relation(fields: [subjectId], references: [id])
+  subject      Subject                  @relation(fields: [subjectId], references: [id])
   subjectId    Int
   @@unique([classRoomId, dayOfTheWeek, startHour, endHour], name: "onlyOneClassRoom")
 }
@@ -101,9 +101,9 @@
   timeTableItemId Int
   @@id([userId, timeTableItemId])
 }
-model TimeTableSubject {
+model TimeTableTimeTableItem {
   timeTable       TimeTable     @relation(fields: [timeTableId], references: [id])
   timeTableId     Int
   timeTableItem   TimeTableItem @relation(fields: [timeTableItemId], references: [id])
   timeTableItemId Int
```


